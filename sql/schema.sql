drop database tball;
create database tball;
use tball;

CREATE TABLE TEAM (
     ID INT (11) NOT NULL AUTO_INCREMENT
     , NAME VARCHAR(100) NOT NULL
     , UNIQUE UQ_TEAM_1 (NAME)
     , PRIMARY KEY (ID)
);

CREATE TABLE COACH_WIP (
    ID INT (11) NOT NULL AUTO_INCREMENT
    , TEAM_ID INT (11) NOT NULL
    , EMAIL VARCHAR(100) NOT NULL
    , COACH_KEY VARCHAR(100) NOT NULL
    , REGISTERED TINYINT(1) NOT NULL DEFAULT 0
    , PRIMARY KEY (ID)
    , UNIQUE UQ_COACH_WIP_1 (EMAIL, COACH_KEY)
    , CONSTRAINT FK_COACH_WIP_1 FOREIGN KEY (TEAM_ID)
      REFERENCES TEAM (ID)
);

CREATE TABLE COACH (
     ID INT (11) NOT NULL AUTO_INCREMENT
     , TEAM_ID INT (11) NOT NULL
     , FIRST_NAME VARCHAR(100) NOT NULL
     , LAST_NAME VARCHAR(100) NOT NULL
     , USER_NAME VARCHAR(100) NOT NULL
     , EMAIL VARCHAR(100) NOT NULL
     , PWD VARCHAR(100) NOT NULL
     , ADMIN TINYINT(1) NOT NULL DEFAULT 0
     , PRIMARY KEY (ID)
     , UNIQUE UQ_COACH_1 (USER_NAME, EMAIL)
     , CONSTRAINT FK_COACH_1 FOREIGN KEY (TEAM_ID)
       REFERENCES TEAM (ID)
);

CREATE TABLE PLAYER (
     ID INT (11) NOT NULL AUTO_INCREMENT
     , TEAM_ID INT (11) NOT NULL
     , FIRST_NAME VARCHAR(100) NOT NULL
     , LAST_NAME VARCHAR(100) NOT NULL
     , PRIMARY KEY (ID)
     , UNIQUE UQ_PLAYER_1 (TEAM_ID, FIRST_NAME, LAST_NAME)
     , CONSTRAINT FK_PLAYER_1 FOREIGN KEY (TEAM_ID)
       REFERENCES TEAM (ID)
);

CREATE TABLE POSITION (
	ID INT (11) NOT NULL AUTO_INCREMENT
	, NAME VARCHAR(100) NOT NULL
    , DEFAULT_POSITION TINYINT(1) NOT NULL DEFAULT 0
    , UNIQUE UQ_POSITION_1 (NAME)
	, PRIMARY KEY (ID)
);

CREATE TABLE GAME (
    ID INT (11) NOT NULL AUTO_INCREMENT
    , TEAM_ID INT (11) NOT NULL
    , GAME_NAME VARCHAR(100) NOT NULL
    , PRIMARY KEY (ID)
    , UNIQUE UQ_GAME_1 (TEAM_ID, GAME_NAME)
    , CONSTRAINT FK_GAME_1 FOREIGN KEY (TEAM_ID)
      REFERENCES TEAM (ID)
);

CREATE TABLE PLAYER_POSITION (
	PLAYER_ID INT (11) NOT NULL
	, POSITION_ID INT (11) NOT NULL
    , GAME_ID INT (11) NOT NULL
    , INNING INT (11) NOT NULL
    , BAT_ORDER INT (11) NOT NULL
    , UNIQUE UQ_PLAYER_POSITION_1 (PLAYER_ID, POSITION_ID, GAME_ID, INNING)
	, CONSTRAINT FK_PLAYER_POSITION_1 FOREIGN KEY (PLAYER_ID)
      REFERENCES PLAYER (ID)
	, CONSTRAINT FK_PLAYER_POSITION_2 FOREIGN KEY (POSITION_ID)
      REFERENCES POSITION (ID)
    , CONSTRAINT FK_PLAYER_POSITION_3 FOREIGN KEY (GAME_ID)
      REFERENCES GAME (ID)
);

CREATE TABLE BATTING_ORDER (
    ID INT (11) NOT NULL AUTO_INCREMENT
    , TEAM_ID INT (11) NOT NULL
    , BAT_ORDER INT (11) NOT NULL DEFAULT 5
    , PRIMARY KEY (ID)
    , CONSTRAINT FK_BATTING_ORDER_1 FOREIGN KEY (TEAM_ID)
      REFERENCES TEAM (ID)
);
